<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#"><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <title>Vagrant | HPCCloud</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://kitware.github.io/HPCCloud/docs/vagrant__introduction.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://kitware.github.io/HPCCloud/docs/vagrant__introduction.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/HPCCloud/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/HPCCloud/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/HPCCloud/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/HPCCloud/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/HPCCloud/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/HPCCloud/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/HPCCloud/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/HPCCloud/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/HPCCloud/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/HPCCloud/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/HPCCloud/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/HPCCloud/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/HPCCloud/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/HPCCloud/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/HPCCloud/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/HPCCloud/atom.xml" title="HPCCloud">
  <!-- Open Graph -->
  <meta name="description" content="Relying on Vagrant for deploying the HPCCloud infrastructure’s is great but we can’t assuming that it will always work and additional interaction with the infrastructure may be required. Therefore, th">
<meta property="og:type" content="website">
<meta property="og:title" content="Vagrant">
<meta property="og:url" content="https://kitware.github.io/HPCCloud/docs/vagrant__introduction.html">
<meta property="og:site_name" content="HPCCloud">
<meta property="og:description" content="Relying on Vagrant for deploying the HPCCloud infrastructure’s is great but we can’t assuming that it will always work and additional interaction with the infrastructure may be required. Therefore, th">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-09-02T18:49:05.173Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vagrant">
<meta name="twitter:description" content="Relying on Vagrant for deploying the HPCCloud infrastructure’s is great but we can’t assuming that it will always work and additional interaction with the infrastructure may be required. Therefore, th">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90338862-3', 'auto');
  ga('send', 'pageview');
</script>

</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/HPCCloud/" id="logo">ParaViewWeb</a>
    </h1>
    <nav id="main-nav">
      <a href="/HPCCloud/docs/" class="main-nav-link">Docs</a>
      <a href="https://github.com/kitware/HPCCloud" class="main-nav-link"><i class="fa fa-github-alt"></i></a>
      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">Vagrant</h1>
              </header>
              <div class="article-content" itemprop="articleBody">
                <p>Relying on Vagrant for deploying the HPCCloud infrastructure’s is great but we can’t assuming that it will always work and additional interaction with the infrastructure may be required. Therefore, that documentation aims to provide various <code>how to</code> with Vagrant and HPCCloud deployment.</p>
<h2 id="Setting-up-HPCCloud-for-development" class="article-heading"><a href="#Setting-up-HPCCloud-for-development" class="headerlink" title="Setting-up HPCCloud for development"></a>Setting-up HPCCloud for development<a class="article-anchor" href="#Setting-up-HPCCloud-for-development" aria-hidden="true"></a></h2><p>The very first time you may want to run the following commands.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ mkdir HPCCloud</span><br><span class="line">$ <span class="built_in">cd</span> HPCCloud</span><br><span class="line"></span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/Kitware/HPCCloud.git hpccloud</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/Kitware/HPCCloud-deploy.git</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/Kitware/cumulus.git</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/Kitware/girder.git</span><br><span class="line"></span><br><span class="line">$ virtualenv python</span><br><span class="line">$ <span class="built_in">source</span> ./python/bin/activate</span><br><span class="line">$ pip install -r hpccloud/requirements.txt</span><br><span class="line">$ pip install -r HPCCloud-deploy/requirements.txt</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> HPCCloud-deploy</span><br><span class="line">$ DEVELOPMENT=1 vagrant up</span><br></pre></td></tr></table></figure>
<p>Then you can simply start again the Virtual Machine with the following commands.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> HPCCloud</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ./python/bin/activate</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> HPCCloud-deploy</span><br><span class="line">$ DEVELOPMENT=1 vagrant up</span><br></pre></td></tr></table></figure>
<p>In order to fully stop the Virtual Machine, you can run the following commands.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> HPCCloud</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ./python/bin/activate</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> HPCCloud-deploy</span><br><span class="line">$ vagrant halt</span><br></pre></td></tr></table></figure>
<h2 id="SSH-to-Virtual-Machine" class="article-heading"><a href="#SSH-to-Virtual-Machine" class="headerlink" title="SSH to Virtual Machine"></a>SSH to Virtual Machine<a class="article-anchor" href="#SSH-to-Virtual-Machine" aria-hidden="true"></a></h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> HPCCloud</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ./python/bin/activate</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> HPCCloud-deploy</span><br><span class="line">$ vagrant ssh</span><br><span class="line">$ sudo -iu hpccloud</span><br><span class="line">$ <span class="built_in">cd</span> /opt/hpccloud</span><br></pre></td></tr></table></figure>
<p>Once logged to the VM, services can be stoped and restarted with the following commands</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo service girder [stop/start/restart]</span><br><span class="line">sudo service celeryd [stop/start/restart]</span><br></pre></td></tr></table></figure>
<h2 id="Fixing-invalid-Hostname" class="article-heading"><a href="#Fixing-invalid-Hostname" class="headerlink" title="Fixing invalid Hostname"></a>Fixing invalid Hostname<a class="article-anchor" href="#Fixing-invalid-Hostname" aria-hidden="true"></a></h2><p>When HPCCloud run jobs on a remote cluster, that cluster needs to contact back the HPCCloud server and therefore the proper information needs to be given to those cluster.</p>
<p>This can be adjusted in the following file (replace: HOSTNAME_OR_VALID_IP by the proper value):</p>
<figure class="highlight js"><figcaption><span>/opt/hpccloud/cumulus/cumulus/conf/config.json</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"girder"</span>: &#123;</span><br><span class="line">    <span class="string">"baseUrl"</span>: <span class="string">"http://HOSTNAME_OR_VALID_IP:8080/api/v1"</span>,</span><br><span class="line">    <span class="string">"user"</span>: <span class="string">"cumulus"</span>,</span><br><span class="line">    <span class="string">"group"</span>: <span class="string">"cumulus"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"moabReader"</span>: &#123;</span><br><span class="line">    <span class="string">"pluginPath"</span>: <span class="string">"/opt/hpccloud/moabreader/build/libvtkCmbMoabReaderPlugin.so"</span></span><br><span class="line">  &#125;,</span><br><span class="line">    <span class="string">"ssh"</span>: &#123;</span><br><span class="line">    <span class="string">"keyStore"</span>: <span class="string">"/opt/hpccloud/keys"</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="string">"amis"</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"taskflow"</span>: &#123;</span><br><span class="line">    <span class="string">"path"</span>: [<span class="string">"/opt/hpccloud/hpccloud/server/taskflows"</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Same for girder so <code>http://localhost:8080</code> properly reach girder</p>
<figure class="highlight js"><figcaption><span>/opt/hpccloud/girder/girder/conf/girder.local.cfg</span></figcaption><table><tr><td class="code"><pre><span class="line">[global]</span><br><span class="line">server.socket_host = <span class="string">"0.0.0.0"</span></span><br><span class="line">server.socket_port = <span class="number">8080</span></span><br><span class="line">server.thread_pool = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<h2 id="Running-Celery-by-hand" class="article-heading"><a href="#Running-Celery-by-hand" class="headerlink" title="Running Celery by hand"></a>Running Celery by hand<a class="article-anchor" href="#Running-Celery-by-hand" aria-hidden="true"></a></h2><p>This can be usefull to follow any runtime error live or if the taskflow did properly load.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ /usr/bin/python -m celery worker --app=cumulus --loglevel=INFO --config=cumulus.celery.commandconfig --concurrency=6 --logfile=/var/<span class="built_in">log</span>/celery/command.log --pidfile=/var/run/celery/command.pid --hostname=<span class="built_in">command</span>@vagrant-ubuntu-trusty-64</span><br></pre></td></tr></table></figure>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2019-09-02T18:49:05.173Z" itemprop="dateModified">Last updated: 2019-09-02</time>
                <a href="development__tools.html" class="article-footer-prev" title="Available tools"><i class="fa fa-chevron-left"></i><span>Prev</span></a><a href="workflows__introduction.html" class="article-footer-next" title="Introduction"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setting-up-HPCCloud-for-development"><span class="toc-text">Setting-up HPCCloud for development</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-to-Virtual-Machine"><span class="toc-text">SSH to Virtual Machine</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fixing-invalid-Hostname"><span class="toc-text">Fixing invalid Hostname</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Running-Celery-by-hand"><span class="toc-text">Running Celery by hand</span></a></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner"><strong class="sidebar-title">Basics</strong><a href="index.html" class="sidebar-link">Introduction</a><a href="general__getting-started.html" class="sidebar-link">Getting Started</a><a href="general__troubleshooting.html" class="sidebar-link">Troubleshooting</a><a href="general__glossary.html" class="sidebar-link">Glossary</a><strong class="sidebar-title">Usage</strong><a href="usage__create-account.html" class="sidebar-link">Signing up</a><a href="usage__trad-cluster.html" class="sidebar-link">Adding traditional clusters</a><a href="usage__aws-profiles.html" class="sidebar-link">Adding AWS profiles</a><a href="usage__ebs-volumes.html" class="sidebar-link">Adding EBS volumes</a><a href="usage__creating.html" class="sidebar-link">Projects and simulations</a><a href="usage__simput.html" class="sidebar-link">Simput</a><a href="usage__running.html" class="sidebar-link">Running workflows</a><a href="usage__sharing.html" class="sidebar-link">Groups and project sharing</a><strong class="sidebar-title">Development</strong><a href="development__dev-intro.html" class="sidebar-link">Introduction</a><a href="development__panels.html" class="sidebar-link">Panels</a><a href="development__redux.html" class="sidebar-link">Redux data model</a><a href="development__tools.html" class="sidebar-link">Available tools</a><a href="vagrant__introduction.html" class="sidebar-link current">Vagrant - How to...</a><strong class="sidebar-title">Workflows</strong><a href="workflows__introduction.html" class="sidebar-link">Introduction</a><a href="workflows__adding.html" class="sidebar-link">Workflow definition</a><a href="workflows__pages.html" class="sidebar-link">Workflow pages</a></div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2019 <a href="http://www.kitware.com" target="_blank">Kitware Inc.</a>
    </div>
    <div id="footer-links">
      <a href="https://github.com/kitware/HPCCloud" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/HPCCloud/docs/" class="mobile-nav-link">Docs</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/kitware/HPCCloud" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Basics</strong><a href="index.html" class="mobile-nav-link">Introduction</a><a href="general__getting-started.html" class="mobile-nav-link">Getting Started</a><a href="general__troubleshooting.html" class="mobile-nav-link">Troubleshooting</a><a href="general__glossary.html" class="mobile-nav-link">Glossary</a><strong class="mobile-nav-title">Usage</strong><a href="usage__create-account.html" class="mobile-nav-link">Signing up</a><a href="usage__trad-cluster.html" class="mobile-nav-link">Adding traditional clusters</a><a href="usage__aws-profiles.html" class="mobile-nav-link">Adding AWS profiles</a><a href="usage__ebs-volumes.html" class="mobile-nav-link">Adding EBS volumes</a><a href="usage__creating.html" class="mobile-nav-link">Projects and simulations</a><a href="usage__simput.html" class="mobile-nav-link">Simput</a><a href="usage__running.html" class="mobile-nav-link">Running workflows</a><a href="usage__sharing.html" class="mobile-nav-link">Groups and project sharing</a><strong class="mobile-nav-title">Development</strong><a href="development__dev-intro.html" class="mobile-nav-link">Introduction</a><a href="development__panels.html" class="mobile-nav-link">Panels</a><a href="development__redux.html" class="mobile-nav-link">Redux data model</a><a href="development__tools.html" class="mobile-nav-link">Available tools</a><a href="vagrant__introduction.html" class="mobile-nav-link current">Vagrant - How to...</a><strong class="mobile-nav-title">Workflows</strong><a href="workflows__introduction.html" class="mobile-nav-link">Introduction</a><a href="workflows__adding.html" class="mobile-nav-link">Workflow definition</a><a href="workflows__pages.html" class="mobile-nav-link">Workflow pages</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="docs/vagrant__introduction.html">
      
        <option value="en" selected>English</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/HPCCloud/js/lang_select.js"></script>
<script src="/HPCCloud/js/toc.js"></script>
<script src="/HPCCloud/js/mobile_nav.js"></script>
<!-- endbuild -->
<script src="https://cdn.jsdelivr.net/retinajs/1.3.0/retina.min.js" async></script>



</body>
</html>